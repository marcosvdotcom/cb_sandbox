---
# basic layout for compound object items
# uses _includes/item/child/ includes to add multiple objects to the item page in a gallery
# each object is represented in a modal
layout: item/item-page-base
gallery: true
custom-foot: js/modal-hash-js.html
---
{% assign children = site.data[site.metadata] | where_exp: 'item','item.parentid == page.objectid' %}

<div class="mb-4 ">
    
    {% if page.object_location %}<a href="{{ page.object_location | relative_url }}" target="_blank" rel="noopener">{% endif %}
        {% if page.image_thumb or page.image_small %}
        <img class="img-thumbnail" src="{{ page.image_small | default: page.image_thumb | relative_url }}" alt="{{ page.image_alt_text | default: page.description | default: page.title | escape }}">
        {% else %}
        <svg class="bi text-body" fill="currentColor" aria-hidden="true">
            {%- assign icon_template = page.display_template | default: page.format -%}
            <use xlink:href="{{ '/assets/lib/cb-icons.svg' | relative_url }}#{% if icon_template contains 'image' %}icon-image{% elsif icon_template contains 'pdf' %}icon-pdf{% elsif icon_template contains 'audio' %}icon-audio{% elsif icon_template contains 'video' %}icon-video{% elsif icon_template contains 'record' %}icon-record{% else %}icon-default{% endif %}"/>
        </svg>
        <span class="visually-hidden">{{ page.title | escape }} - {{ page.format }}</span>
        {% endif %}
    {% if page.object_location %}</a>{% endif %}

    <div class="my-2">
        
        <div class="btn-group my-3" role="group" aria-label="Item options">
            {% if page.date %}{%- capture year -%}{% if page.date contains "-" %}{{ page.date | split: "-" | first }}{% elsif page.date contains "/" %}{{ page.date | split: "/" | last }}{% else %}{{ page.date }}{% endif %}{%- endcapture -%}
            <a href="{{ year | strip | prepend: '/timeline.html#y' | relative_url }}" class="btn btn-outline-primary">View on Timeline</a>{% endif %}
            {% if page.latitude and page.longitude %}
            <a href="{{ '/map.html?location=' | append: page.latitude  | append: ',' | append: page.longitude | append: '&marker=' | append: page.objectid | relative_url }}" class="btn btn-outline-primary">View on Map</a>{% endif %}
        
            <div class="btn-group" role="group">
                <button class="btn btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Download Model File
                </button>
                <ul class="dropdown-menu">
                    {% if page.object_location %}<li><a target="_blank" rel="noopener" href="{{ page.object_location | relative_url }}" class="dropdown-item">{{ page.title }} ({{ page.format | split: '/' | last | upcase }})</a></li>{% endif %}
                    {% for child in children %}
                    {% unless child.object_location == nil %}
                    <li>
                        <a target="_blank" rel="noopener" href="{{ child.object_location | relative_url }}" class="dropdown-item">
                            {% if page.title != child.title and child.title != nil %}{{ child.title | truncatewords: 3 }}{% elsif child.extension %}{{ child.extension }}{% else %}Item {{ forloop.index }}{% endif %}
                            {% if child.format %}({{ child.format | split: '/' | last | upcase }}){% endif %}
                        </a>
                    </li>
                    {% endunless %}
                    {% endfor %}
                </ul>
            </div>
        </div>

    </div>
</div>
